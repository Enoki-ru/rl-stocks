## PositionalEncoding

### üó∫Ô∏è –ü–ª–∞–Ω –û—Ç–≤–µ—Ç–∞

1.  **üéØ –ö–æ–Ω—Ü–µ–ø—Ü–∏—è –∏ –ü–µ—Ä–≤—ã–µ –ü—Ä–∏–Ω—Ü–∏–ø—ã:** –ü–æ—á–µ–º—É `PositionalEncoding` –≤–æ–æ–±—â–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º? –ö–∞–∫—É—é –ø—Ä–æ–±–ª–µ–º—É –æ–Ω —Ä–µ—à–∞–µ—Ç –Ω–∞ —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç–∞–ª—å–Ω–æ–º —É—Ä–æ–≤–Ω–µ?
2.  **üî¨ –ü–æ—Å—Ç—Ä–æ—á–Ω—ã–π –ê–Ω–∞–ª–∏–∑ –ö–æ–¥–∞:** –î–µ—Ç–∞–ª—å–Ω—ã–π —Ä–∞–∑–±–æ—Ä –∫–ª–∞—Å—Å–∞ `PositionalEncoding`, –≤–∫–ª—é—á–∞—è –º–µ—Ç–æ–¥—ã `__init__` –∏ `forward`.
3.  **üíé –ö–ª—é—á–µ–≤–æ–π –í—ã–≤–æ–¥:** –°–∏–Ω—Ç–µ–∑ –ø–æ–ª—É—á–µ–Ω–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –≤ –æ–¥–∏–Ω –≥–ª–∞–≤–Ω—ã–π –∏–Ω—Å–∞–π—Ç.
4.  **üí∞ –ë–∏–∑–Ω–µ—Å-–ö–æ–Ω—Ç–µ–∫—Å—Ç:** –ö–∞–∫ –ø–æ–Ω–∏–º–∞–Ω–∏–µ —ç—Ç–æ–≥–æ –º–µ—Ö–∞–Ω–∏–∑–º–∞ —Ç—Ä–∞–Ω—Å–ª–∏—Ä—É–µ—Ç—Å—è –≤ —Å–æ–∑–¥–∞–Ω–∏–µ —Ü–µ–Ω–Ω–æ—Å—Ç–∏.
5.  **üí° –ö–∞—Ç–∞–ª–∏–∑–∞—Ç–æ—Ä –ó–Ω–∞–Ω–∏–π:** –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ñ–∞–∫—Ç—ã –¥–ª—è —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è –∫—Ä—É–≥–æ–∑–æ—Ä–∞.
6.  **üìö –í–µ–∫—Ç–æ—Ä—ã –í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏:** –°—Å—ã–ª–∫–∏ –¥–ª—è —É–≥–ª—É–±–ª–µ–Ω–Ω–æ–≥–æ –∏–∑—É—á–µ–Ω–∏—è –∏ –ø—Ä–æ–≤–µ—Ä–∫–∏.
7.  **üöÄ –í–∞—à –°–ª–µ–¥—É—é—â–∏–π –®–∞–≥:** –ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ –ø–æ –¥–∞–ª—å–Ω–µ–π—à–µ–º—É –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—é —Ç–µ–º—ã.

---

### üéØ –ö–æ–Ω—Ü–µ–ø—Ü–∏—è –∏ –ü–µ—Ä–≤—ã–µ –ü—Ä–∏–Ω—Ü–∏–ø—ã

–û—Å–Ω–æ–≤–Ω–æ–π –º–µ—Ö–∞–Ω–∏–∑–º –¢—Ä–∞–Ω—Å—Ñ–æ—Ä–º–µ—Ä–∞, *self-attention* (—Å–∞–º–æ-–≤–Ω–∏–º–∞–Ω–∏–µ), –ø–æ —Å–≤–æ–µ–π –ø—Ä–∏—Ä–æ–¥–µ –∏–Ω–≤–∞—Ä–∏–∞–Ω—Ç–µ–Ω –∫ –ø–µ—Ä–µ—Å—Ç–∞–Ω–æ–≤–∫–∞–º. –≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –µ—Å–ª–∏ –≤—ã –ø–æ–º–µ–Ω—è–µ—Ç–µ —Å–ª–æ–≤–∞ –≤ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–∏ –º–µ—Å—Ç–∞–º–∏, —Ä–µ–∑—É–ª—å—Ç–∞—Ç —Ä–∞–±–æ—Ç—ã –º–µ—Ö–∞–Ω–∏–∑–º–∞ –≤–Ω–∏–º–∞–Ω–∏—è –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Å–ª–æ–≤–∞ –±—É–¥–µ—Ç –∏–¥–µ–Ω—Ç–∏—á–Ω—ã–º. –î–ª—è –Ω–µ–≥–æ —Ñ—Ä–∞–∑—ã "—Å–æ–±–∞–∫–∞ —É–∫—É—Å–∏–ª–∞ —á–µ–ª–æ–≤–µ–∫–∞" –∏ "—á–µ–ª–æ–≤–µ–∫–∞ —É–∫—É—Å–∏–ª–∞ —Å–æ–±–∞–∫–∞" ‚Äî —ç—Ç–æ –ø—Ä–æ—Å—Ç–æ –Ω–µ—É–ø–æ—Ä—è–¥–æ—á–µ–Ω–Ω—ã–π –Ω–∞–±–æ—Ä –≤–µ–∫—Ç–æ—Ä–æ–≤ ("–º–µ—à–æ–∫ —Å–ª–æ–≤").

–≠—Ç–æ —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç–∞–ª—å–Ω–∞—è –ø—Ä–æ–±–ª–µ–º–∞, —Ç–∞–∫ –∫–∞–∫ –ø–æ—Ä—è–¥–æ–∫ –≤ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—è—Ö (—Ç–µ–∫—Å—Ç, –≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Ä—è–¥—ã) –Ω–µ—Å–µ—Ç –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é.

**–ó–∞–¥–∞—á–∞:** –ö–∞–∫ —Å–æ–æ–±—â–∏—Ç—å –º–æ–¥–µ–ª–∏, –Ω–∞ –∫–∞–∫–æ–π –ø–æ–∑–∏—Ü–∏–∏ –≤ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –∫–∞–∂–¥—ã–π —Ç–æ–∫–µ–Ω (—Å–ª–æ–≤–æ, –∞–∫—Ç–∏–≤)?

**–†–µ—à–µ–Ω–∏–µ –∏–∑ —Å—Ç–∞—Ç—å–∏ "Attention Is All You Need":** –î–æ–±–∞–≤–∏—Ç—å –∫ –≤–µ–∫—Ç–æ—Ä—É –∫–∞–∂–¥–æ–≥–æ —Ç–æ–∫–µ–Ω–∞ —É–Ω–∏–∫–∞–ª—å–Ω—ã–π "—Å–∏–≥–Ω–∞–ª" –∏–ª–∏ "–æ—Ç–ø–µ—á–∞—Ç–æ–∫" –µ–≥–æ –ø–æ–∑–∏—Ü–∏–∏. –≠—Ç–æ—Ç "–æ—Ç–ø–µ—á–∞—Ç–æ–∫" –∏ –µ—Å—Ç—å `PositionalEncoding`.

**–ü–æ—á–µ–º—É –∏–º–µ–Ω–Ω–æ —Å–∏–Ω—É—Å—ã –∏ –∫–æ—Å–∏–Ω—É—Å—ã?**
–ê–≤—Ç–æ—Ä—ã –º–æ–≥–ª–∏ –±—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø—Ä–æ—Å—Ç—ã–µ –∏–Ω–¥–µ–∫—Å—ã (0, 1, 2...), –Ω–æ —ç—Ç–æ —Å–æ–∑–¥–∞–ª–æ –±—ã –ø—Ä–æ–±–ª–µ–º—ã:
1.  **–ù–µ–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–π –¥–∏–∞–ø–∞–∑–æ–Ω:** –ó–Ω–∞—á–µ–Ω–∏—è –º–æ–≥–ª–∏ –±—ã —Ä–∞—Å—Ç–∏ –¥–æ –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ—Å—Ç–∏, —á—Ç–æ –¥–µ—Å—Ç–∞–±–∏–ª–∏–∑–∏—Ä—É–µ—Ç –æ–±—É—á–µ–Ω–∏–µ.
2.  **–ü—Ä–æ–±–ª–µ–º–∞ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è:** –†–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É –ø–æ–∑–∏—Ü–∏—è–º–∏ 0 –∏ 1 –Ω–µ —ç–∫–≤–∏–≤–∞–ª–µ–Ω—Ç–Ω–∞ —Ä–∞–∑–Ω–∏—Ü–µ –º–µ–∂–¥—É 1000 –∏ 1001 —Å —Ç–æ—á–∫–∏ –∑—Ä–µ–Ω–∏—è –≤–ª–∏—è–Ω–∏—è –Ω–∞ –º–æ–¥–µ–ª—å.

–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ **—Å–∏–Ω—É—Å–æ–∏–¥–∞–ª—å–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π** —Ä–µ—à–∞–µ—Ç —ç—Ç–∏ –ø—Ä–æ–±–ª–µ–º—ã —ç–ª–µ–≥–∞–Ω—Ç–Ω–æ:
1.  **–û–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–π –¥–∏–∞–ø–∞–∑–æ–Ω:** –ó–Ω–∞—á–µ–Ω–∏—è `sin` –∏ `cos` –≤—Å–µ–≥–¥–∞ –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ –¥–∏–∞–ø–∞–∑–æ–Ω–µ [-1, 1].
2.  **–û—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–µ –ø–æ–∑–∏—Ü–∏–∏:** –ö–ª—é—á–µ–≤–æ–µ —Å–≤–æ–π—Å—Ç–≤–æ. –ü–æ–∑–∏—Ü–∏–æ–Ω–Ω–æ–µ –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –ø–æ–∑–∏—Ü–∏–∏ `pos+k` –º–æ–∂–µ—Ç –±—ã—Ç—å –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–æ –∫–∞–∫ –ª–∏–Ω–µ–π–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –æ—Ç –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è –¥–ª—è –ø–æ–∑–∏—Ü–∏–∏ `pos`. –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –º–æ–¥–µ–ª–∏ –ª–µ–≥–∫–æ –≤—ã—É—á–∏—Ç—å –æ—Ç–Ω–æ—à–µ–Ω–∏—è –º–µ–∂–¥—É —Ç–æ–∫–µ–Ω–∞–º–∏ –Ω–∞ —Ä–∞–∑–Ω—ã—Ö —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—è—Ö –¥—Ä—É–≥ –æ—Ç –¥—Ä—É–≥–∞.
3.  **–£–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç—å:** –ö–∞–∂–¥–∞—è –ø–æ–∑–∏—Ü–∏—è –ø–æ–ª—É—á–∞–µ—Ç —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –≤–µ–∫—Ç–æ—Ä –∫–æ–¥–∏—Ä–æ–≤–∫–∏.
4.  **–î–µ—Ç–µ—Ä–º–∏–Ω–∏–∑–º:** –í–µ–∫—Ç–æ—Ä—ã –Ω–µ –æ–±—É—á–∞—é—Ç—Å—è, –∞ –≤—ã—á–∏—Å–ª—è—é—Ç—Å—è –ø–æ —Ñ–æ—Ä–º—É–ª–µ, —á—Ç–æ —ç–∫–æ–Ω–æ–º–∏—Ç —Ä–µ—Å—É—Ä—Å—ã –∏ –¥–µ–ª–∞–µ—Ç –º–æ–¥–µ–ª—å —Å—Ç–∞–±–∏–ª—å–Ω–µ–µ.

---

### üî¨ –ü–æ—Å—Ç—Ä–æ—á–Ω—ã–π –ê–Ω–∞–ª–∏–∑ –ö–æ–¥–∞

–†–∞–∑–±–µ—Ä–µ–º —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é –Ω–∞ **PyTorch** —Å—Ç—Ä–æ–∫–∞ –∑–∞ —Å—Ç—Ä–æ–∫–æ–π.

#### üèõÔ∏è –û–±—â–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –∫–ª–∞—Å—Å–∞

```python
class PositionalEncoding(nn.Module):
```
-   **–ß—Ç–æ —ç—Ç–æ:** –û–±—ä—è–≤–ª–µ–Ω–∏–µ –∫–ª–∞—Å—Å–∞ `PositionalEncoding`, –∫–æ—Ç–æ—Ä—ã–π –Ω–∞—Å–ª–µ–¥—É–µ—Ç—Å—è –æ—Ç `nn.Module`.
-   **–ü–æ—á–µ–º—É —Ç–∞–∫:** `nn.Module` ‚Äî —ç—Ç–æ –±–∞–∑–æ–≤—ã–π –∫–ª–∞—Å—Å –¥–ª—è –≤—Å–µ—Ö –Ω–µ–π—Ä–æ—Å–µ—Ç–µ–≤—ã—Ö –º–æ–¥—É–ª–µ–π –≤ PyTorch. –ù–∞—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ –æ—Ç –Ω–µ–≥–æ –¥–∞–µ—Ç –Ω–∞—à–µ–º—É –∫–ª–∞—Å—Å—É –º–∞—Å—Å—É –ø–æ–ª–µ–∑–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π: –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ (`nn.Parameter`), –±—É—Ñ–µ—Ä–æ–≤ (`register_buffer`), –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –ø–µ—Ä–µ–º–µ—â–∞—Ç—å –º–æ–¥–µ–ª—å –º–µ–∂–¥—É CPU –∏ GPU (`.to(device)`) –∏ —Ç.–¥. –≠—Ç–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è –ø—Ä–∞–∫—Ç–∏–∫–∞ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –ª—é–±—ã—Ö –∫–∞—Å—Ç–æ–º–Ω—ã—Ö —Å–ª–æ–µ–≤.

#### ‚öôÔ∏è –ú–µ—Ç–æ–¥ `__init__` (–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è)

```python
def __init__(self, d_model: int, dropout: float = 0.1, max_len: int = 50):
    super().__init__()
    self.dropout = nn.Dropout(p=dropout)
```
-   `__init__`: –ö–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä –∫–ª–∞—Å—Å–∞. –ü—Ä–∏–Ω–∏–º–∞–µ—Ç –Ω–∞ –≤—Ö–æ–¥:
    -   `d_model`: –†–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å –≤–µ–∫—Ç–æ—Ä–æ–≤ —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤. –ü–æ–∑–∏—Ü–∏–æ–Ω–Ω–∞—è –∫–æ–¥–∏—Ä–æ–≤–∫–∞ –¥–æ–ª–∂–Ω–∞ –∏–º–µ—Ç—å —Ç—É –∂–µ —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å, —á—Ç–æ–±—ã –∏—Ö –º–æ–∂–Ω–æ –±—ã–ª–æ —Å–ª–æ–∂–∏—Ç—å.
    -   `dropout`: –í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –∑–∞–Ω—É–ª–µ–Ω–∏—è —ç–ª–µ–º–µ–Ω—Ç–æ–≤. –≠—Ç–æ —Ç–µ—Ö–Ω–∏–∫–∞ —Ä–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏–∏ –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è.
    -   `max_len`: –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –¥–ª–∏–Ω–∞ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏, –¥–ª—è –∫–æ—Ç–æ—Ä–æ–π –º—ã –∑–∞—Ä–∞–Ω–µ–µ –≤—ã—á–∏—Å–ª—è–µ–º –∫–æ–¥–∏—Ä–æ–≤–∫–∏.
-   `super().__init__()`: –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π –≤—ã–∑–æ–≤ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä–∞ —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–æ–≥–æ –∫–ª–∞—Å—Å–∞ `nn.Module`.
-   `self.dropout = nn.Dropout(p=dropout)`: –°–æ–∑–¥–∞–Ω–∏–µ —Å–ª–æ—è Dropout, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç –ø—Ä–∏–º–µ–Ω—è—Ç—å—Å—è –≤ –º–µ—Ç–æ–¥–µ `forward`.

---

##### üßÆ –í—ã—á–∏—Å–ª–µ–Ω–∏–µ –º–∞—Ç—Ä–∏—Ü—ã –ø–æ–∑–∏—Ü–∏–æ–Ω–Ω—ã—Ö –∫–æ–¥–∏—Ä–æ–≤–æ–∫

–≠—Ç–æ —è–¥—Ä–æ –∫–ª–∞—Å—Å–∞. –ó–¥–µ—Å—å —Ä–µ–∞–ª–∏–∑—É—é—Ç—Å—è —Ñ–æ—Ä–º—É–ª—ã –∏–∑ —Å—Ç–∞—Ç—å–∏.

```python
position = torch.arange(max_len).unsqueeze(1)
```
-   **–ß—Ç–æ —ç—Ç–æ:** –°–æ–∑–¥–∞–Ω–∏–µ —Ç–µ–Ω–∑–æ—Ä–∞ –ø–æ–∑–∏—Ü–∏–π.
-   `torch.arange(max_len)`: –°–æ–∑–¥–∞–µ—Ç —Ç–µ–Ω–∑–æ—Ä —Å —Ü–µ–ª—ã–º–∏ —á–∏—Å–ª–∞–º–∏ –æ—Ç 0 –¥–æ `max_len-1`. –ù–∞–ø—Ä–∏–º–µ—Ä, –¥–ª—è `max_len=50` —ç—Ç–æ –±—É–¥–µ—Ç `[0, 1, 2, ..., 49]`.
-   `.unsqueeze(1)`: –î–æ–±–∞–≤–ª—è–µ—Ç –Ω–æ–≤—É—é –æ—Å—å, –ø—Ä–µ–≤—Ä–∞—â–∞—è –æ–¥–Ω–æ–º–µ—Ä–Ω—ã–π —Ç–µ–Ω–∑–æ—Ä `[50]` –≤ –¥–≤—É–º–µ—Ä–Ω—ã–π `[50, 1]`. –≠—Ç–æ –Ω—É–∂–Ω–æ –¥–ª—è –ø–æ—Å–ª–µ–¥—É—é—â–∏—Ö –º–∞—Ç—Ä–∏—á–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π (broadcast).
-   **–†–µ–∑—É–ª—å—Ç–∞—Ç:** `position` ‚Äî —ç—Ç–æ –≤–µ–∫—Ç–æ—Ä-—Å—Ç–æ–ª–±–µ—Ü `[[0], [1], [2], ..., [49]]`.

```python
div_term = torch.exp(torch.arange(0, d_model, 2) * (-math.log(10000.0) / d_model))
```
-   **–ß—Ç–æ —ç—Ç–æ:** –í—ã—á–∏—Å–ª–µ–Ω–∏–µ –¥–µ–ª–∏—Ç–µ–ª—è –≤ —Ñ–æ—Ä–º—É–ª–µ. –≠—Ç–æ —á–∞—Å—Ç—å, –æ—Ç–≤–µ—á–∞—é—â–∞—è –∑–∞ —Ä–∞–∑–Ω—ã–µ —á–∞—Å—Ç–æ—Ç—ã —Å–∏–Ω—É—Å–æ–∏–¥.
-   `torch.arange(0, d_model, 2)`: –°–æ–∑–¥–∞–µ—Ç —Ç–µ–Ω–∑–æ—Ä —á–µ—Ç–Ω—ã—Ö —á–∏—Å–µ–ª –æ—Ç 0 –¥–æ `d_model-1` —Å —à–∞–≥–æ–º 2. –≠—Ç–æ –∏–Ω–¥–µ–∫—Å—ã `2i` –∏–∑ —Ñ–æ—Ä–º—É–ª—ã. –ù–∞–ø—Ä–∏–º–µ—Ä, –¥–ª—è `d_model=128` —ç—Ç–æ –±—É–¥–µ—Ç `[0, 2, 4, ..., 126]`.
-   `* (-math.log(10000.0) / d_model)`: –ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ —ç—Ç–∏—Ö –∏–Ω–¥–µ–∫—Å–æ–≤. `log(10000)` ‚Äî —ç—Ç–æ –ø—Ä–æ—Å—Ç–æ –∫–æ–Ω—Å—Ç–∞–Ω—Ç–∞, –≤—ã–±—Ä–∞–Ω–Ω–∞—è –∞–≤—Ç–æ—Ä–∞–º–∏. –î–µ–ª–µ–Ω–∏–µ –Ω–∞ `d_model` –Ω–æ—Ä–º–∞–ª–∏–∑—É–µ—Ç –∑–Ω–∞—á–µ–Ω–∏—è.
-   `torch.exp(...)`: –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ —ç–∫—Å–ø–æ–Ω–µ–Ω—Ç—ã. –í –∏—Ç–æ–≥–µ –º—ã –ø–æ–ª—É—á–∞–µ–º `1 / (10000^(2i/d_model))`, —á—Ç–æ –≤ —Ç–æ—á–Ω–æ—Å—Ç–∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –∑–Ω–∞–º–µ–Ω–∞—Ç–µ–ª—é –≤ —Ñ–æ—Ä–º—É–ª–µ –∏–∑ —Å—Ç–∞—Ç—å–∏.
-   **–†–µ–∑—É–ª—å—Ç–∞—Ç:** `div_term` ‚Äî —ç—Ç–æ –≤–µ–∫—Ç–æ—Ä-—Å—Ç—Ä–æ–∫–∞, —Å–æ–¥–µ—Ä–∂–∞—â–∏–π —É–±—ã–≤–∞—é—â–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä—ã–µ –æ–ø—Ä–µ–¥–µ–ª—è—é—Ç —á–∞—Å—Ç–æ—Ç—É –∫–æ–ª–µ–±–∞–Ω–∏–π —Å–∏–Ω—É—Å–æ–≤ –∏ –∫–æ—Å–∏–Ω—É—Å–æ–≤.

```python
pe = torch.zeros(max_len, 1, d_model)
```
-   **–ß—Ç–æ —ç—Ç–æ:** –°–æ–∑–¥–∞–Ω–∏–µ "–ø—É—Å—Ç–æ–π" –º–∞—Ç—Ä–∏—Ü—ã –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –ø–æ–∑–∏—Ü–∏–æ–Ω–Ω—ã—Ö –∫–æ–¥–∏—Ä–æ–≤–æ–∫.
-   **–ü–æ—á–µ–º—É —Ç–∞–∫:** –ú—ã —Å–æ–∑–¥–∞–µ–º —Ç—Ä–µ—Ö–º–µ—Ä–Ω—ã–π —Ç–µ–Ω–∑–æ—Ä `[max_len, 1, d_model]`. `max_len` ‚Äî –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–∑–∏—Ü–∏–π, `d_model` ‚Äî —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å –≤–µ–∫—Ç–æ—Ä–∞ –¥–ª—è –∫–∞–∂–¥–æ–π –ø–æ–∑–∏—Ü–∏–∏. –ï–¥–∏–Ω–∏—Ü–∞ –≤ —Å–µ—Ä–µ–¥–∏–Ω–µ ‚Äî —ç—Ç–æ "batch" —Ä–∞–∑–º–µ—Ä, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ä–∞—Å—à–∏—Ä–µ–Ω (broadcasted) –ø—Ä–∏ —Å–ª–æ–∂–µ–Ω–∏–∏ —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏.

```python
pe[:, 0, 0::2] = torch.sin(position * div_term)
pe[:, 0, 1::2] = torch.cos(position * div_term)
```
-   **–ß—Ç–æ —ç—Ç–æ:** –ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –º–∞—Ç—Ä–∏—Ü—ã `pe` –∑–Ω–∞—á–µ–Ω–∏—è–º–∏ —Å–∏–Ω—É—Å–æ–≤ –∏ –∫–æ—Å–∏–Ω—É—Å–æ–≤.
-   `pe[:, 0, 0::2]`: –í—ã–±–æ—Ä –≤—Å–µ—Ö –ø–æ–∑–∏—Ü–∏–π (`:`), –ø–µ—Ä–≤–æ–≥–æ (–∏ –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ) —ç–ª–µ–º–µ–Ω—Ç–∞ "–±–∞—Ç—á–∞" (`0`), –∏ –≤—Å–µ—Ö *—á–µ—Ç–Ω—ã—Ö* –∏–Ω–¥–µ–∫—Å–æ–≤ –≤ —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏ `d_model` (`0::2`).
-   `torch.sin(position * div_term)`: –ì–ª–∞–≤–Ω–æ–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏–µ. –ú—ã —É–º–Ω–æ–∂–∞–µ–º –≤–µ–∫—Ç–æ—Ä-—Å—Ç–æ–ª–±–µ—Ü `position` `[50, 1]` –Ω–∞ –≤–µ–∫—Ç–æ—Ä-—Å—Ç—Ä–æ–∫—É `div_term` `[1, d_model/2]`. –ë–ª–∞–≥–æ–¥–∞—Ä—è broadcasting, —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–º –±—É–¥–µ—Ç –º–∞—Ç—Ä–∏—Ü–∞ `[50, d_model/2]`, –≥–¥–µ –∫–∞–∂–¥—ã–π —ç–ª–µ–º–µ–Ω—Ç ‚Äî —Ä–µ–∑—É–ª—å—Ç–∞—Ç —É–º–Ω–æ–∂–µ–Ω–∏—è –Ω–æ–º–µ—Ä–∞ –ø–æ–∑–∏—Ü–∏–∏ –Ω–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â—É—é —á–∞—Å—Ç–æ—Ç—É. –ó–∞—Ç–µ–º –æ—Ç —ç—Ç–æ–π –º–∞—Ç—Ä–∏—Ü—ã –±–µ—Ä–µ—Ç—Å—è —Å–∏–Ω—É—Å.
-   `pe[:, 0, 1::2] = torch.cos(...)`: –ê–Ω–∞–ª–æ–≥–∏—á–Ω–æ, –Ω–æ –¥–ª—è *–Ω–µ—á–µ—Ç–Ω—ã—Ö* –∏–Ω–¥–µ–∫—Å–æ–≤ (`1::2`) –∏ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –∫–æ—Å–∏–Ω—É—Å–∞.
-   **–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ú–∞—Ç—Ä–∏—Ü–∞ `pe` –∑–∞–ø–æ–ª–Ω–µ–Ω–∞. –î–ª—è –∫–∞–∂–¥–æ–π –ø–æ–∑–∏—Ü–∏–∏ `pos` –µ–µ –≤–µ–∫—Ç–æ—Ä –∫–æ–¥–∏—Ä–æ–≤–∫–∏ `pe[pos]` –≤—ã–≥–ª—è–¥–∏—Ç —Ç–∞–∫: `[sin(pos/freq_0), cos(pos/freq_0), sin(pos/freq_1), cos(pos/freq_1), ...]`.

```python
self.register_buffer('pe', pe)
```
-   **–ß—Ç–æ —ç—Ç–æ:** –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —Ç–µ–Ω–∑–æ—Ä–∞ `pe` –∫–∞–∫ –±—É—Ñ–µ—Ä–∞ –º–æ–¥—É–ª—è.
-   **–ü–æ—á–µ–º—É —Ç–∞–∫:** `pe` ‚Äî —ç—Ç–æ –Ω–µ –æ–±—É—á–∞–µ–º—ã–π –ø–∞—Ä–∞–º–µ—Ç—Ä (–º—ã –Ω–µ —Ö–æ—Ç–∏–º, —á—Ç–æ–±—ã –≥—Ä–∞–¥–∏–µ–Ω—Ç–Ω—ã–π —Å–ø—É—Å–∫ –µ–≥–æ –º–µ–Ω—è–ª), –Ω–æ –æ–Ω —è–≤–ª—è–µ—Ç—Å—è —á–∞—Å—Ç—å—é —Å–æ—Å—Ç–æ—è–Ω–∏—è –º–æ–¥–µ–ª–∏. `register_buffer` –¥–µ–ª–∞–µ—Ç –¥–≤–µ –≤–µ—â–∏:
    1.  –¢–µ–Ω–∑–æ—Ä –±—É–¥–µ—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω –≤–º–µ—Å—Ç–µ —Å —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º –º–æ–¥–µ–ª–∏ (`state_dict`).
    2.  –¢–µ–Ω–∑–æ—Ä –±—É–¥–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–º–µ—â–∞—Ç—å—Å—è –º–µ–∂–¥—É CPU –∏ GPU –ø—Ä–∏ –≤—ã–∑–æ–≤–µ `.to(device)` –¥–ª—è –≤—Å–µ–π –º–æ–¥–µ–ª–∏.
-   –≠—Ç–æ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Å–ø–æ—Å–æ–± —Ö—Ä–∞–Ω–∏—Ç—å –ø–æ—Å—Ç–æ—è–Ω–Ω—ã–µ, –Ω–æ –≤–∞–∂–Ω—ã–µ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å–ª–æ—è –¥–∞–Ω–Ω—ã–µ, –≤ –æ—Ç–ª–∏—á–∏–µ –æ—Ç `nn.Parameter` (–¥–ª—è –æ–±—É—á–∞–µ–º—ã—Ö –≤–µ—Å–æ–≤) –∏–ª–∏ –ø—Ä–æ—Å—Ç–æ–≥–æ `self.pe = pe` (—Ç–µ–Ω–∑–æ—Ä –Ω–µ –±—É–¥–µ—Ç —É–ø—Ä–∞–≤–ª—è—Ç—å—Å—è `nn.Module`).

#### ‚û°Ô∏è –ú–µ—Ç–æ–¥ `forward` (–ü—Ä—è–º–æ–π –ø—Ä–æ—Ö–æ–¥)

```python
def forward(self, x: torch.Tensor) -> torch.Tensor:
    """
    x: Tensor, shape [seq_len, batch_size, d_model]
    """
    x = x + self.pe[:x.size(0)]
    return self.dropout(x)
```
-   `forward(self, x)`: –ú–µ—Ç–æ–¥, –∫–æ—Ç–æ—Ä—ã–π –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è, –∫–æ–≥–¥–∞ –º—ã "–≤—ã–∑—ã–≤–∞–µ–º" –Ω–∞—à —Å–ª–æ–π: `model(input)`.
-   `x`: –í—Ö–æ–¥–Ω–æ–π —Ç–µ–Ω–∑–æ—Ä —Å —ç–º–±–µ–¥–¥–∏–Ω–≥–∞–º–∏ —Ç–æ–∫–µ–Ω–æ–≤. –ï–≥–æ —Ñ–æ—Ä–º–∞ `[seq_len, batch_size, d_model]`. `seq_len` ‚Äî –¥–ª–∏–Ω–∞ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –≤ –¥–∞–Ω–Ω–æ–º –±–∞—Ç—á–µ, `batch_size` ‚Äî –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–µ–π –≤ –±–∞—Ç—á–µ, `d_model` ‚Äî —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å —ç–º–±–µ–¥–¥–∏–Ω–≥–∞.
-   `self.pe[:x.size(0)]`: –ú—ã –±–µ—Ä–µ–º –∏–∑ –Ω–∞—à–µ–≥–æ –∑–∞—Ä–∞–Ω–µ–µ –≤—ã—á–∏—Å–ª–µ–Ω–Ω–æ–≥–æ –±—É—Ñ–µ—Ä–∞ `pe` —Ç–æ–ª—å–∫–æ —Ç—É —á–∞—Å—Ç—å, –∫–æ—Ç–æ—Ä–∞—è —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Ä–µ–∞–ª—å–Ω–æ–π –¥–ª–∏–Ω–µ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ `x.size(0)`. –≠—Ç–æ –¥–µ–ª–∞–µ—Ç –º–æ–¥–µ–ª—å –≥–∏–±–∫–æ–π –∫ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—è–º —Ä–∞–∑–Ω–æ–π –¥–ª–∏–Ω—ã (–Ω–æ –Ω–µ –¥–ª–∏–Ω–Ω–µ–µ `max_len`).
-   `x = x + ...`: **–ö–ª—é—á–µ–≤–∞—è –æ–ø–µ—Ä–∞—Ü–∏—è.** –ú—ã –ø—Ä–æ—Å—Ç–æ –ø–æ—ç–ª–µ–º–µ–Ω—Ç–Ω–æ —Å–∫–ª–∞–¥—ã–≤–∞–µ–º —Ç–µ–Ω–∑–æ—Ä —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤ `x` —Å —Ç–µ–Ω–∑–æ—Ä–æ–º –ø–æ–∑–∏—Ü–∏–æ–Ω–Ω—ã—Ö –∫–æ–¥–∏—Ä–æ–≤–æ–∫. –ë–ª–∞–≥–æ–¥–∞—Ä—è broadcasting'—É, —Ç–µ–Ω–∑–æ—Ä `pe` —Ñ–æ—Ä–º—ã `[seq_len, 1, d_model]` –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ "—Ä–∞—Å—Ç—è–≥–∏–≤–∞–µ—Ç—Å—è" –ø–æ –æ—Å–∏ `batch_size` –∏ —Å–∫–ª–∞–¥—ã–≤–∞–µ—Ç—Å—è —Å –∫–∞–∂–¥—ã–º —ç–ª–µ–º–µ–Ω—Ç–æ–º –±–∞—Ç—á–∞.
-   `return self.dropout(x)`: –ü—Ä–∏–º–µ–Ω—è–µ–º Dropout –∫ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—É –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ–º –µ–≥–æ.

---

### üíé –ö–ª—é—á–µ–≤–æ–π –í—ã–≤–æ–¥

**`PositionalEncoding` ‚Äî —ç—Ç–æ –¥–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–π (–Ω–µ–æ–±—É—á–∞–µ–º—ã–π) –∏–Ω—ä–µ–∫—Ü–∏–æ–Ω–Ω—ã–π –º–µ—Ö–∞–Ω–∏–∑–º, –∫–æ—Ç–æ—Ä—ã–π —Ä–µ—à–∞–µ—Ç —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç–∞–ª—å–Ω—É—é –ø—Ä–æ–±–ª–µ–º—É –∏–Ω–≤–∞—Ä–∏–∞–Ω—Ç–Ω–æ—Å—Ç–∏ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã –¢—Ä–∞–Ω—Å—Ñ–æ—Ä–º–µ—Ä –∫ –ø–æ—Ä—è–¥–∫—É —ç–ª–µ–º–µ–Ω—Ç–æ–≤. –û–Ω "–≤–∂–∏–≤–ª—è–µ—Ç" –≤ –≤–µ–∫—Ç–æ—Ä–Ω–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –∫–∞–∂–¥–æ–≥–æ —Ç–æ–∫–µ–Ω–∞ —É–Ω–∏–∫–∞–ª—å–Ω—ã–π —Å–∏–Ω—É—Å–æ–∏–¥–∞–ª—å–Ω—ã–π —Å–∏–≥–Ω–∞–ª, –∫–æ–¥–∏—Ä—É—é—â–∏–π –µ–≥–æ –∞–±—Å–æ–ª—é—Ç–Ω—É—é –ø–æ–∑–∏—Ü–∏—é, —á—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –º–æ–¥–µ–ª–∏ –≤—ã—É—á–∏–≤–∞—Ç—å –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–µ –ø–æ–∑–∏—Ü–∏–æ–Ω–Ω—ã–µ –æ—Ç–Ω–æ—à–µ–Ω–∏—è –º–µ–∂–¥—É —Ç–æ–∫–µ–Ω–∞–º–∏.**

---

### üí∞ –ë–∏–∑–Ω–µ—Å-–ö–æ–Ω—Ç–µ–∫—Å—Ç

-   **–ü–æ–≤—ã—à–µ–Ω–∏–µ –ö–∞—á–µ—Å—Ç–≤–∞ –ú–æ–¥–µ–ª–µ–π:** –ë–µ–∑ –ø–æ–∑–∏—Ü–∏–æ–Ω–Ω–æ–≥–æ –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è –¢—Ä–∞–Ω—Å—Ñ–æ—Ä–º–µ—Ä—ã –±—ã–ª–∏ –±—ã –±–µ—Å–ø–æ–ª–µ–∑–Ω—ã –¥–ª—è –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–∞ –∑–∞–¥–∞—á —Å –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏ (NLP, –ø—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ä—è–¥–æ–≤). –ü–æ–Ω–∏–º–∞–Ω–∏–µ —ç—Ç–æ–≥–æ –º–µ—Ö–∞–Ω–∏–∑–º–∞ –ø–æ–∑–≤–æ–ª—è–µ—Ç –≤–∞–º –∫–∞–∫ –∞–Ω–∞–ª–∏—Ç–∏–∫—É –±–æ–ª–µ–µ —Ç–æ—á–Ω–æ –æ—Ü–µ–Ω–∏–≤–∞—Ç—å –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª –∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –º–æ–¥–µ–ª–µ–π –Ω–∞ –æ—Å–Ω–æ–≤–µ –¢—Ä–∞–Ω—Å—Ñ–æ—Ä–º–µ—Ä–æ–≤ –¥–ª—è —Ä–µ—à–µ–Ω–∏—è –±–∏–∑–Ω–µ—Å-–∑–∞–¥–∞—á.
-   **–≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –†–µ—Å—É—Ä—Å–æ–≤:** –î–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ö–∞—Ä–∞–∫—Ç–µ—Ä –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è (–æ–Ω–æ –≤—ã—á–∏—Å–ª—è–µ—Ç—Å—è, –∞ –Ω–µ –æ–±—É—á–∞–µ—Ç—Å—è) —ç–∫–æ–Ω–æ–º–∏—Ç –≤—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã –∏ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –º–æ–¥–µ–ª–∏. –≠—Ç–æ –Ω–∞–ø—Ä—è–º—É—é –≤–ª–∏—è–µ—Ç –Ω–∞ —Å—Ç–æ–∏–º–æ—Å—Ç—å –æ–±—É—á–µ–Ω–∏—è –∏ –∏–Ω—Ñ–µ—Ä–µ–Ω—Å–∞ (`cost-to-serve`), —á—Ç–æ —è–≤–ª—è–µ—Ç—Å—è –≤–∞–∂–Ω—ã–º –±–∏–∑–Ω–µ—Å-–ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–º.
-   **–ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å (–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–∞—è):** –•–æ—Ç—è —Å–∞–º–∞ –º–æ–¥–µ–ª—å ‚Äî "—á–µ—Ä–Ω—ã–π —è—â–∏–∫", –ø–æ–Ω–∏–º–∞–Ω–∏–µ —Ç–æ–≥–æ, –∫–∞–∫ –∏–º–µ–Ω–Ω–æ –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–æ–∑–∏—Ü–∏–∏, –¥–∞–µ—Ç –æ–¥–∏–Ω –∏–∑ –∫–ª—é—á–µ–π –∫ –∞–Ω–∞–ª–∏–∑—É –µ–µ –ø–æ–≤–µ–¥–µ–Ω–∏—è.

---

### üí° –ö–∞—Ç–∞–ª–∏–∑–∞—Ç–æ—Ä –ó–Ω–∞–Ω–∏–π

1.  **–û–±—É—á–∞–µ–º—ã–µ –ü–æ–∑–∏—Ü–∏–æ–Ω–Ω—ã–µ –≠–º–±–µ–¥–¥–∏–Ω–≥–∏:** –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π –ø–æ–¥—Ö–æ–¥, –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–π, –Ω–∞–ø—Ä–∏–º–µ—Ä, –≤ –º–æ–¥–µ–ª—è—Ö **BERT** –∏ **GPT**. –í–º–µ—Å—Ç–æ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–π —Å–∏–Ω—É—Å–æ–∏–¥–∞–ª—å–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–∏ —Å–æ–∑–¥–∞–µ—Ç—Å—è –ø—Ä–æ—Å—Ç–∞—è —Ç–∞–±–ª–∏—Ü–∞ —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤ (`nn.Embedding`), –≥–¥–µ –¥–ª—è –∫–∞–∂–¥–æ–π –ø–æ–∑–∏—Ü–∏–∏ (0, 1, 2...) –µ—Å—Ç—å —Å–≤–æ–π –æ–±—É—á–∞–µ–º—ã–π –≤–µ–∫—Ç–æ—Ä. –≠—Ç–æ –ø—Ä–æ—â–µ –≤ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏, –Ω–æ –º–æ–∂–µ—Ç —Ö—É–∂–µ –æ–±–æ–±—â–∞—Ç—å—Å—è –Ω–∞ –¥–ª–∏–Ω—ã –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–µ–π, –Ω–µ –≤—Å—Ç—Ä–µ—á–∞–≤—à–∏–µ—Å—è –ø—Ä–∏ –æ–±—É—á–µ–Ω–∏–∏.
2.  **Rotary Positional Embedding (RoPE):** –ë–æ–ª–µ–µ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π –∏ —Å–ª–æ–∂–Ω—ã–π –º–µ—Ç–æ–¥, –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–π –≤ –º–æ–¥–µ–ª—è—Ö LLaMA –∏ PaLM. –í–º–µ—Å—Ç–æ *–¥–æ–±–∞–≤–ª–µ–Ω–∏—è* –ø–æ–∑–∏—Ü–∏–æ–Ω–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –∫ –≤–µ–∫—Ç–æ—Ä–∞–º, RoPE *–ø–æ–≤–æ—Ä–∞—á–∏–≤–∞–µ—Ç* –≤–µ–∫—Ç–æ—Ä—ã –Ω–∞ —É–≥–æ–ª, –∑–∞–≤–∏—Å—è—â–∏–π –æ—Ç –∏—Ö –ø–æ–∑–∏—Ü–∏–∏. –≠—Ç–æ —ç–ª–µ–≥–∞–Ω—Ç–Ω–æ –≤—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—É—é –ø–æ–∑–∏—Ü–∏–æ–Ω–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –Ω–µ–ø–æ—Å—Ä–µ–¥—Å—Ç–≤–µ–Ω–Ω–æ –≤ –º–µ—Ö–∞–Ω–∏–∑–º self-attention.
3.  **–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –≤–Ω–µ NLP:** –¢–∞ –∂–µ —Å–∞–º–∞—è —Ç–µ—Ö–Ω–∏–∫–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ –º–æ–¥–µ–ª—è—Ö Vision Transformer (ViT) –¥–ª—è –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è –ø–æ–∑–∏—Ü–∏–π "–ø–∞—Ç—á–µ–π" (–∫—É—Å–æ—á–∫–æ–≤ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è), —á—Ç–æ –¥–æ–∫–∞–∑—ã–≤–∞–µ—Ç —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–æ—Å—Ç—å —ç—Ç–æ–≥–æ –ø–æ–¥—Ö–æ–¥–∞.

---

### üìö –í–µ–∫—Ç–æ—Ä—ã –í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏

-   **"Attention Is All You Need"**: –û—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–∞—è –Ω–∞—É—á–Ω–∞—è —Å—Ç–∞—Ç—å—è, –≥–¥–µ –±—ã–ª–∞ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∞ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –¢—Ä–∞–Ω—Å—Ñ–æ—Ä–º–µ—Ä –∏ –ø–æ–∑–∏—Ü–∏–æ–Ω–Ω–æ–µ –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ. [Ashish Vaswani, et al., 2017](https://arxiv.org/abs/1706.03762)
-   **PyTorch `nn.Module`**: –û—Ñ–∏—Ü–∏–∞–ª—å–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –±–∞–∑–æ–≤–æ–≥–æ –∫–ª–∞—Å—Å–∞ –¥–ª—è –≤—Å–µ—Ö –º–æ–¥—É–ª–µ–π. [pytorch.org](https://pytorch.org/docs/stable/generated/torch.nn.Module.html)
-   **PyTorch `register_buffer`**: –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ –º–µ—Ç–æ–¥—É —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –±—É—Ñ–µ—Ä–æ–≤. [pytorch.org](https://pytorch.org/docs/stable/generated/torch.nn.Module.html#torch.nn.Module.register_buffer)
-   **The Illustrated Transformer**: –û—Ç–ª–∏—á–Ω–∞—è –≤–∏–∑—É–∞–ª—å–Ω–∞—è —Å—Ç–∞—Ç—å—è, –æ–±—ä—è—Å–Ω—è—é—â–∞—è –¢—Ä–∞–Ω—Å—Ñ–æ—Ä–º–µ—Ä –∏ –ø–æ–∑–∏—Ü–∏–æ–Ω–Ω–æ–µ –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ. [Jay Alammar's Blog](https://jalammar.github.io/illustrated-transformer/)
-   **–¢—Ä–∞–Ω—Å—Ñ–æ—Ä–º–µ—Ä (–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –Ω–µ–π—Ä–æ–Ω–Ω–æ–π —Å–µ—Ç–∏)**: –°—Ç–∞—Ç—å—è –≤ Wikipedia –¥–ª—è –æ–±—â–µ–≥–æ –æ–±–∑–æ—Ä–∞. [ru.wikipedia.org](https://ru.wikipedia.org/wiki/–¢—Ä–∞–Ω—Å—Ñ–æ—Ä–º–µ—Ä_(–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞_–Ω–µ–π—Ä–æ–Ω–Ω–æ–π_—Å–µ—Ç–∏))
